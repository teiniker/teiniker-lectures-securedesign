# Trivy

The **open-soucre vulnerability scanner** trivy is for vulnerabilities (CVE) & misconfigurations across code repositories, binary artifacts, container images, and Kubernetes clusters.

## Setup 

```bash
$ wget https://github.com/aquasecurity/trivy/releases/download/v0.69.0/trivy_0.69.0_Linux-64bit.deb
$ sudo dpkg -i trivy_0.69.0_Linux-64bit.deb

$ trivy --version
Version: 0.69.0
```

## Basic Docker Image Scan

Scann a local Docker Image for vulnerabilities:

```
$ docker pull mongo:4.4

$ docker image inspect mongo:4.4
[
    {
        "Id": "sha256:0010f63d26952bd3960fac5513c64a1cf7d6299f31fa7b54ac1b36633ee04333",
        "RepoTags": [
            "mongo:4.4"
        ],
        "RepoDigests": [
            "mongo@sha256:4be76f674fc4b27859816811b8baa3c51830eb1dbf4ca81a51e26b79edd662ef"
        ],
        "Parent": "",
        "Comment": "buildkit.dockerfile.v0",
        "Created": "2025-12-29T20:13:14.290438749Z",
        "DockerVersion": "",
        "Author": "",
        "Architecture": "amd64",
        "Os": "linux",
...
            "User": "",
            "Volumes": {
                "/data/configdb": {},
                "/data/db": {}
            },
            "WorkingDir": ""
        }
    }
]
```

Now let's **scan the image for known vulnerabilities**:

```bash
$ trivy image mongo:4.4

2026-02-05T18:03:46+01:00	INFO	[vuln] Vulnerability scanning is enabled
2026-02-05T18:03:46+01:00	INFO	[secret] Secret scanning is enabled
2026-02-05T18:03:46+01:00	INFO	[secret] If your scanning is slow, please try '--scanners vuln' to disable secret scanning
2026-02-05T18:03:46+01:00	INFO	[secret] Please see https://trivy.dev/docs/v0.69/guide/scanner/secret#recommendation for faster secret detection
2026-02-05T18:03:59+01:00	INFO	Detected OS	family="ubuntu" version="24.04"
2026-02-05T18:03:59+01:00	INFO	[ubuntu] Detecting vulnerabilities...	os_version="24.04" pkg_num=128
2026-02-05T18:03:59+01:00	INFO	Number of language-specific files	num=10
2026-02-05T18:03:59+01:00	INFO	[gobinary] Detecting vulnerabilities...
2026-02-05T18:03:59+01:00	INFO	[node-pkg] Detecting vulnerabilities...
2026-02-05T18:03:59+01:00	WARN	Using severities from other vendors for some vulnerabilities. Read https://trivy.dev/docs/v0.69/guide/scanner/vulnerability#severity-selection for details.
2026-02-05T18:03:59+01:00	INFO	Table result includes only package filenames. Use '--format json' option to get the full path to the package file.

Report Summary

┌──────────────────────────┬──────────┬─────────────────┬─────────┐
│          Target          │   Type   │ Vulnerabilities │ Secrets │
├──────────────────────────┼──────────┼─────────────────┼─────────┤
│ mongo (ubuntu 24.04)     │  ubuntu  │       25        │    -    │
├──────────────────────────┼──────────┼─────────────────┼─────────┤
│ opt/js-yaml/package.json │ node-pkg │        1        │    -    │
├──────────────────────────┼──────────┼─────────────────┼─────────┤
│ usr/bin/bsondump         │ gobinary │       21        │    -    │
├──────────────────────────┼──────────┼─────────────────┼─────────┤
│ usr/bin/mongodump        │ gobinary │       21        │    -    │
├──────────────────────────┼──────────┼─────────────────┼─────────┤
│ usr/bin/mongoexport      │ gobinary │       21        │    -    │
├──────────────────────────┼──────────┼─────────────────┼─────────┤
│ usr/bin/mongofiles       │ gobinary │       21        │    -    │
├──────────────────────────┼──────────┼─────────────────┼─────────┤
│ usr/bin/mongoimport      │ gobinary │       21        │    -    │
├──────────────────────────┼──────────┼─────────────────┼─────────┤
│ usr/bin/mongorestore     │ gobinary │       21        │    -    │
├──────────────────────────┼──────────┼─────────────────┼─────────┤
│ usr/bin/mongostat        │ gobinary │       21        │    -    │
├──────────────────────────┼──────────┼─────────────────┼─────────┤
│ usr/bin/mongotop         │ gobinary │       21        │    -    │
├──────────────────────────┼──────────┼─────────────────┼─────────┤
│ usr/local/bin/gosu       │ gobinary │       15        │    -    │
└──────────────────────────┴──────────┴─────────────────┴─────────┘
Legend:
- '-': Not scanned
- '0': Clean (no security findings detected)
```

## Scan Dockerfiles 

Trivy can scan `Dockerfiles` for best-practice violations and misconfigurations.

```
$ trivy config Dockerfile
```


## Severity Filtering

For filtering we use an older image (f.e `docker pull alpine:3.1`)

Scan only **high** and **critical** vulnerabilities:

```
$ trivy image --severity HIGH,CRITICAL mongo:4.4
```


## Output Formats

JSON Output

```
$ trivy image --format json --output trivy-report.json mongo:4.4
```


## References
* [YouTube: Docker vulnerability scanning tool Trivy](https://www.youtube.com/watch?v=pZumqxTwLNw)

* [Trivy](https://trivy.dev/docs/latest/getting-started/)

*Nicoletta Kähling, Egon Teiniker, 2017-2026, GPL v3.0*
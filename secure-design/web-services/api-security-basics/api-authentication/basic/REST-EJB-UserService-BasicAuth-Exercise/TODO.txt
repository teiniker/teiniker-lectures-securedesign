Exercise: Basic Authentication
-------------------------------------------------------------------------------

You have given a working REST service.

A) Deploy & Test the REST Service
    - Start the database server and import the SQL script: setup.sql
        $ sudo systemctl start mariadb.service
        $ mysql -u student -pstudent
        MariaDB [(none)]> use testdb;

    - Deploy the REST service into Wildfly
        $ mvn wildfly:deploy

    - Use curl to access the REST service
        $ curl -i -k https://localhost:8443/REST-EJB-UserService-BasicAuth-Exercise/v1/users

B) Configure Basic Authentication
    - Add an Application User to the Wildfly configuration
        $ cd JBOSS_HOME/bin
        $ ./add-user.sh
        - Application user
        - username: student
        - password: student
        - roles: user
        - new user used for AS to AS communication: no
        => JBOSS_HOME/standalone/configuration/application-users.properties
            student=82364171bad00c2c933b216cac1001d4
        => JBOSS_HOME/standalone/configuration/application-roles.properties
            student=user

    - Extend the web.xml to configure a <security-role>,  <security-constraint>,
        and <login-config> element:

        <security-role>
            <role-name>user</role-name>
        </security-role>

        <security-constraint>
            <web-resource-collection>
                <web-resource-name>All resources</web-resource-name>
                <url-pattern>/*</url-pattern>
            </web-resource-collection>
            <auth-constraint>
                <role-name>user</role-name>
            </auth-constraint>
            <user-data-constraint>
                <transport-guarantee>CONFIDENTIAL</transport-guarantee>
            </user-data-constraint>
        </security-constraint>

        <login-config>
            <auth-method>BASIC</auth-method>
            <realm-name>ApplicationRealm</realm-name>
        </login-config>

C) Experiments
    1. Send an unauthorized request and analyze the response:
        $ curl -i -k https://localhost:8443/REST-EJB-UserService-BasicAuth-Exercise/v1/users

    2. Send authentication information and analyze the request (HTTP headers) and response:
        $ curl -v -k --user student:student https://localhost:8443/REST-EJB-UserService-BasicAuth-Exercise/v1/users

    3. Send authentication information of an unknown user and analyze the response:
        $ curl -v -k --user homer:1234567 https://localhost:8443/REST-EJB-UserService-BasicAuth-Exercise/v1/users

D) Code Review
    Analyze the source code of the example to understand how it is working.
    Discuss how the authentication is working and where it is implemented.

Tip: Don't forget to undeploy the service after your experiments.
    $ mvn wildfly:undeploy
